<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Org Chart Interaktif</title>
  <script src="https://cdn.balkan.app/orgchart.js"></script>
  <style>
    html, body {
      width: 100%;
      height: 100%;
      padding: 0;
      margin: 0;
      overflow: hidden;
      font-family: Helvetica;
    }
    #tree {
      width: 100%;
      height: 100%;
    }
  </style>
</head>
<body>
  <div id="tree"></div>
  <script>
    let chart = new OrgChart(document.getElementById("tree"), {
        mouseScrool: OrgChart.action.none,
        nodeMenu: {
            add: {text: "Add New"},
            edit: {text: "Edit"},
            remove: {text: "Remove"}
        },
        editForm: {
            photoBinding: "ImgUrl",
            elements: [
                { type: 'textbox', label: 'Photo Url', binding: 'ImgUrl', btn: 'Upload' },
            ]
        },
        nodeBinding: {
            field_0: "EmployeeName",
            field_1: "Title",
            img_0: "ImgUrl"
        }
    });

    // Event listener ketika node di-update
    chart.onUpdateNode(function(args){
        console.log("Old data:", args.oldData);
        console.log("New data:", args.newData);
    });

    // Event listener ketika node dihapus
    chart.onRemoveNode(function(args){
        console.log("Removed node ID:", args.id);
    });

    // Event listener ketika node baru ditambah
    chart.onAddNode(function(args){
        console.log("Added node data:", args.data);
    });

    // Event listener tombol upload di edit form
    chart.editUI.on('element-btn-click', function (sender, args) {
        OrgChart.fileUploadDialog(function (file) {
            let formData = new FormData();
            formData.append('file', file);
            alert('upload the file');
            console.log(args);
        })
    });

    // Data awal struktur
    chart.load([
        { id: "1", EmployeeName: "Jack Hill", Title: "Chairman and CEO", ImgUrl: "https://cdn.balkan.app/shared/16.jpg", tags: ['orange'] },
        { id: "2", pid: "1", EmployeeName: "Budi Suryo", Title: "Manager", ImgUrl: "https://cdn.balkan.app/shared/5.jpg" },
        { id: "3", pid: "1", EmployeeName: "Siti Aminah", Title: "Manager", ImgUrl: "https://cdn.balkan.app/shared/6.jpg" },
        { id: "4", pid: "2", EmployeeName: "Andi Pratama", Title: "Staff", ImgUrl: "https://cdn.balkan.app/shared/7.jpg" },
        { id: "5", pid: "2", EmployeeName: "Rina Dewi", Title: "Staff", ImgUrl: "https://cdn.balkan.app/shared/8.jpg" }
    ]);
  </script>
</body>
</html>
